!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("lodash/core")):"function"==typeof define&&define.amd?define(["lodash/core"],t):(e=e||self).asSys=t(e._)}(this,function(e){"use strict";function h(e,t){if(e.length<2)return!0;for(var n=e[0],r=1,o=e.length;r<o;++r)if(!1===t(n,e[r]))return!1;return!0}function i(e){if(!e)return undefined;if("function"!=typeof e)return e.toString();if(e.name!==undefined)return e.name;var t=e.toString().match(/function ([^\(]+)/);return null!=t?t[1]:""}function j(){for(var e,t,n=[],r=null,o=Array.prototype.slice.call(arguments,0),f=function(){var e=this.__skills;if(!this.__initializing){this.__initializing=!0;for(var t=0,n=e.length;t<n;++t)e[t].apply(this,arguments);delete this.__initializing}},p=0;p<o.length;++p)if(t=o[p],!(-1<n.indexOf(t))){if("function"!=typeof t||!t.prototype)throw{name:"Missing skill",message:"The skill-set listed ["+i(t)+"] is missing.",skill:l};if(t.prototype.__depends){e=[p,0];for(var l,a=0,u=t.prototype.__depends.length;a<u;++a)l=t.prototype.__depends[a],-1==o.indexOf(l)&&e.push(l);if(2<e.length){Array.prototype.splice.apply(o,e),--p;continue}}if(null!=t.prototype.__expects){r=r||{};for(a=0,u=t.prototype.__expects.length;a<u;++a)r[t.prototype.__expects[a]]=!0}if(n.push(t),f.prototype=f.prototype===undefined?Object.create(t.prototype):d(f.prototype,t.prototype),t.prototype.__skills!==undefined){a=0;for(var c,s=t.prototype.__skills.length;a<s;++a)c=t.prototype.__skills[a],-1==n.indexOf(c)&&n.push(c)}}return r&&y(r,function(e,t){if(!f.prototype[t])throw{name:"Unmatched expectation",message:"The expected method ["+t+"] was not found among provided skills.",method:t}}),Object.defineProperties(f.prototype,{__skills:{enumerable:!1,writable:!1,value:n}}),f}var y=e&&"function"==typeof e.each?e.each:$.each,d=e&&"function"==typeof e.extend?e.extend:$.extend,o=e&&"function"==typeof e.equal?e.equal:function(e,t){if("object"!=typeof e||"object"!=typeof t)return e===t;var n={};for(var r in e)if(e.hasOwnProperty(r)){if(!t.hasOwnProperty(r)||!o(e[r],t[r]))return!1;n[r]=!0}for(var r in t)if(!n[r]&&t.hasOwnProperty(r)&&(!e.hasOwnProperty(r)||!o(e[r],t[r])))return!1;return!0},r=function(e,t){if(e instanceof RegExp)return"string"==typeof t&&null!=t.match(e);if(t instanceof RegExp)return"string"==typeof e&&null!=e.match(t);if("object"!=typeof e||"object"!=typeof t)return e==t;for(var n in e)if(e.hasOwnProperty(n)&&t.hasOwnProperty(n)&&!r(e[n],t[n]))return!1;return!0};return j.VERSION="1.0.2",j.equal=function(){return h(arguments,o)},j.similar=function(){return h(arguments,r)},j.title=i,j.setup=function(e){for(var t in e)for(var n=1;n<arguments.length;++n){var r=arguments[n];r&&r[t]!==undefined&&(e[t]=r[t])}return e},j.common=function(e){var t,n={},r={},o={},i=0,f=arguments.length;for("boolean"==typeof e&&(i=1);i<f;++i)for(var p in t=arguments[i])n[p]===undefined?(n[p]=1,r[p]=t[p]):!0===e&&r[p]!==t[p]||++n[p];for(var p in"boolean"==typeof e&&--f,n)n[p]==f&&(o[p]=r[p]);return o},j.weight=function(e){return"object"!=typeof e?1:e.hasOwnProperty("length")&&"number"==typeof e.length?e.length:Object.keys(e).length},j.clone=function(e){var t=Object.create(Object.getPrototypeOf(e));try{return e.constructor.apply(t,Array.prototype.slice(arguments,1))||t}catch(n){}},j.act=function(e,t){if(null!=e)return"string"==typeof t&&(t=e[t]),"function"==typeof t?t.apply(e,Array.prototype.slice.call(arguments,2)):void 0},j.broadcast=function(t,n){var r=Array.prototype.slice.call(arguments,2);return y(t.__skills,function(e){"function"==typeof e.prototype[n]&&e.prototype[n].apply(t,r)}),t},j.pass=function(e,t,n){for(var r,o=e.__skills&&e.__skills.indexOf(t);0<=--o;)if("function"==typeof(r=e.__skills[o]).prototype[n])return r.prototype[n].apply(e,Array.prototype.slice.call(arguments,3))},j.can=function(e,t){return"object"==typeof e&&"function"==typeof e[t]},j.aware=function(e,t){return"object"==typeof e&&e[t]!==undefined},j.capable=function(e,t){var n=Object.getPrototypeOf(e),r=1;"boolean"==typeof t&&(r=2);for(var o,i=0,f=r,p=arguments.length;f<p;++f)if(e instanceof(o=arguments[f]))++i;else if(Array.isArray(n.__skills))-1<n.__skills.indexOf(o)&&++i;else{var l=j.weight(o.prototype);0<l&&j.weight(j.common(!0,e,o.prototype))==l&&++i}return 0<i&&(!0!==t||arguments.length-r==i)},j.group=function(e,t,n){var r=this.clone(e),o={};for(var i in"boolean"!=typeof t&&(n=t,t=!1),e){var f=e[i];n.call(f,f,i,e)&&(t&&d(o,Object.getPrototypeOf(f)),r.push(f))}if(t){for(var p,l=Object.keys(o),a={},u=0,c=l.length;u<c;++u)a[p=l[u]]={enumerable:!1,writable:!1,value:"function"!=typeof o[p]?o[p]:function(r){return function(){var e=undefined;for(var t in this){var n=this[t];"function"==typeof n[r]&&(e=n[r].apply(n,arguments))}return e}}(p)};Object.defineProperties(r,a)}return r},j});