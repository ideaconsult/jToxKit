!function(u,c,d){u.ui=d.extend(u.ui,{templates:{},bakeTemplate:function(t,r,s){var e=d(t);return d("*",e[0]).each(function(t,e){for(var i=null,n={},a=e.attributes,t=0;t<a.length;++t)a[t].specified&&a[t].value.match(u.templateRegExp)&&(n[a[t].name]=a[t].value,a[t].value=u.formatString(a[t].value,r,s));1==e.childNodes.length&&e.childNodes[0].nodeType===Node.TEXT_NODE&&(e=e.childNodes[0]).textContent.match(u.templateRegExp)&&(i=d(e).parent(),n[""]=e.textContent,e.textContent=u.formatString(e.textContent,r,s)),null!=i&&i.addClass("jtox-live-data").data("jtox-live-data",n)}),e},putTemplate:function(t,e,i){var n=u.ui.bakeTemplate(u.ui.templates[t],e);return i?d(i).append(n):n},updateTree:function(t,n,a){d(".jtox-live-data",t).each(function(t,i){d.each(d(i).data("jtox-live-data"),function(t,e){e=u.formatString(e,n,a),""===t?i.innerHTML=e:i.attributes[t]=e})})},fillHtml:function(t,e,i){return u.formatString(u.ui.templates[t],e,i)},getTemplate:function(t,e,i){return d(u.ui.fillHtml(t,e,i))},updateCounter:function(t,e,i){var n=null,a="";return null==e&&(e=0),a=null==i?(n=/\(([\d\?]+)\)$/,""+e):(n=/\(([\d\?]+\/[\d\?\+-]+)\)$/,e+"/"+i),t.match(n)?t=t.replace(n,"("+a+")"):t+=" ("+a+")",t},enterBlur:function(t){13==t.keyCode&&this.blur()},shortenedData:function(t,e,i){var n="";return null==i&&(i=t),i.toString().length<=5?n+=t:(n+='<div class="shortened"><span>'+t+'</div><i class="icon fa fa-copy"',null!=e&&(n+=' title="'+e+'"'),n+=' data-uuid="'+i+'"></i>'),n},linkedData:function(t,e,i){var n="";return null==i&&(i=t),i.toString().length<=5?n+=t:n+=null!=e?n+'<div title="'+e+'">'+t+"</div>":"<div >"+t+"</div>",n},changeTabsIds:function(t,i){d("ul li a",t).each(function(){var t=d(this).attr("href").substr(1),e=document.getElementById(t);t+=i,e.id=t,d(this).attr("href","#"+t)})},addTab:function(t,e,i,n){if(null==document.getElementById(i)){var a=d("<a>",{href:"#"+i}).html(e);return d("ul",t[0]).append(d("<li>").append(a)),"function"==typeof n?n=d(n(t[0])):"string"==typeof n&&(n=d(n)),n.attr("id",i),t.append(n).tabs("refresh"),{tab:a,content:n}}},renderRange:function(t,e,i,n){var a,r,s,o="";return"string"==typeof t||"number"==typeof t?o+="display"!=i?t:(n?n+"&nbsp;=&nbsp;":"")+u.valueAndUnits(t,e):"object"==typeof t&&null!=t?(a=_.trim(t.loValue),r=_.trim(t.upValue),""!=String(a)&&""!=String(r)&&t.upQualifier&&"="!=t.loQualifier?(n&&(o+=n+"&nbsp;=&nbsp;"),o+=">="==t.loQualifier?"[":"(",o+=a+", "+r,o+="<="==t.upQualifier?"]":") "):(s=function(t,e,i){var n="";return t&&(n+=t+" "),e&&(n+=t||"="!=e?e+" ":""),n+i},""!=String(a)?o+=s(n,t.loQualifier||"=",a):""!=String(r)?o+=s(n,t.upQualifier||"=",r):o+=n||("display"==i?"-":"")),o=o.replace(/ /g,"&nbsp;"),"display"==i&&(e=_.trim(t.unit||e))&&(o+='&nbsp;<span class="units">'+e.replace(/ /g,"&nbsp;")+"</span>")):o+="-",o},putInfo:function(t,e){return'<sup class="helper"><a target="_blank" href="'+(t||"#")+'" title="'+(e||t)+'"><span class="ui-icon ui-icon-info"></span></a></sup>'},renderRelation:function(t,e,i){if("display"!=e)return _.map(t,"relation").join(",");for(var n="",a=0,r=t.length;a<r;++a)n+="<span>"+t[a].relation.substring(4).toLowerCase()+"</span>"+u.ui.putInfo(i.URI+"/composition",t[a].compositionName+"("+t[a].compositionUUID+")");return n}}),u.ui=c.extend(u.ui,{rootSettings:{},kitsMap:{},templateRoot:null,callId:0,initKit:function(e){var a=this,r=e.data(),s=r.kit,i=d.extend(!0,{},a.rootSettings),o=null;c.each(e.parents(".jtox-kit,.jtox-widget").toArray().reverse(),function(t){null!=(o=a.kit(t))&&(i=d.extend(!0,i,o))}),o=o||a,(r=d.extend(!0,i,r)).baseUrl=u.fixBaseUrl(r.baseUrl),r.target=e,r.id===undefined&&(r.id=e.attr("id"));var n=function(t,e){if(!s)return null;var i=window[s];"function"!=typeof i&&(s=s.charAt(0).toUpperCase()+s.slice(1),i=u.ui[s]||u[s]);var n=null;return"function"==typeof i?n=new i(t):"object"==typeof i&&"function"==typeof i.init&&(n=i.init(t)),null!=n?(i.prototype.__kits===undefined&&(i.prototype.__kits=[]),i.prototype.__kits.push(n),n.parentKit=o,null!==r.id&&(a.kitsMap[r.id]=n)):console.log("jToxError: trying to initialize unexistent jTox kit: "+s),n};if(null==r.configFile){var t=r.configuration;"string"==typeof t&&(t=window[t]),"function"==typeof t&&(t=t.call(s,r,s)),"object"==typeof t&&d.extend(!0,r,t),delete r.configuration;var l=n(r);return e.data("jtKit",l),l}d.ajax({settings:"GET",url:r.configFile},function(t){t&&d.extend(!0,r,t),e.data("jtKit",n(r))})},initialize:function(t){var e,i,n=this;t||(d(document).on("click",".jtox-kit div.shortened + .icon",function(){return u.copyToClipboard(d(this).data("uuid")),!1}),d(document).on("click",".jtox-foldable>.title",function(t){d(this).parent().toggleClass("folded")}),d(document).on("click",".jtox-diagram .icon",function(){d(this).toggleClass("fa-search-plus fa-search-minus"),d("img",this.parentNode).toggleClass("jtox-smalldiagram")}),i=(e=u.parseURL(document.location)).params,n.rootSettings.baseUrl?i.baseUrl&&(i.baseUrl=u.fixBaseUrl(i.baseUrl)):i.baseUrl=u.formBaseUrl(document.location.href),n.rootSettings=d.extend(!0,n.rootSettings,i),n.fullUrl=e,t=document);var a=function(){d(this).data("manualInit")||n.initKit(d(this))};d(".jtox-kit",t).each(a),d(".jtox-widget",t).each(a)},kit:function(t){return"string"!=typeof t?d(t).data("jtKit"):this.kitsMap[t]!==undefined?this.kitsMap[t]:d("#"+t).data("jtKit")},attachKit:function(t,e){return d(t).data("jtKit",e)},parentKit:function(e,t){var i=this,n=null;return"string"==typeof e&&(e=window[e]),d(t).parents(".jtox-kit").each(function(){var t=i.kit(this);t&&!n&&(!e||t instanceof e)&&(n=t)}),n},insertTool:function(t,e){var i=this.tools[t];return null!=i&&(e.innerHTML=i,this.init(e)),e}}),u.ListWidget=function(t){c.extend(!0,this,c.common(t,this)),this.target=d(t.target),this.length=0,this.clearItems()},u.ListWidget.prototype={itemId:"id",populate:function(t,e){this.items=t,this.length=t.length,this.target.empty().hide();for(var i=0,n=t.length;i<n;i++)this.target.append(this.renderItem("function"==typeof e?e(t[i]):t[i]));this.target.show()},addItem:function(t){return this.items.push(t),++this.length,this.renderItem(t)},clearItems:function(){this.target.empty(),this.items=[],this.length=0},findItem:function(e){var i=this;return c.findIndex(this.items,"string"!=typeof e?e:function(t){return t[i.itemId]===e})},eraseItem:function(t){var e=this.findItem(t),i=0<=e&&this.items.splice(e,1)[0];return this.length=this.items.length,i},enumerateItems:function(t){for(var e=this.target.children(),i=0,n=this.items.length;i<n;++i)t.call(e[i],this.items[i])}},u.TagWidget=function(t){c.extend(!0,this,c.common(t,this)),this.target=d(t.target),this.subtarget&&(this.target=this.target.find(this.subtarget).eq(0)),this.id=t.id,this.color=this.color||this.target.data("color"),this.color&&this.target.addClass(this.color)},u.TagWidget.prototype={__expects:["hasValue","clickHandler"],color:null,renderItem:null,onUpdated:null,subtarget:null,init:function(t){c.pass(this,u.TagWidget,"init",t),this.manager=t},populate:function(t,e){var i,n,a,r=null,s=0;if(null==t.length||0==t.length)e||this.target.html("No items found in this selection").addClass("jt-no-tags");else{this.target.removeClass("jt-no-tags"),t.sort(function(t,e){return(t.value||t.val)<(e.value||e.val)?-1:1}),e||this.target.empty(),this.target.hide();for(var o=0,l=t.length;o<l;o++)a=(r=t[o]).value||r.val,n=this.exclusion&&this.hasValue(a),s+=r.count,r.title=a.toString(),"function"==typeof this.modifyTag&&(r=this.modifyTag(r)),n||(r.onMain=this.clickHandler(a)),this.target.append(i=this.renderItem(r)),n&&i.addClass("selected");this.target.show()}c.act(this,this.onUpdated,s)}},u.AutocompleteWidget=function(t){c.extend(!0,this,c.common(t,this)),this.target=d(t.target),this.lookupMap=t.lookupMap||{}},u.AutocompleteWidget.prototype={__expects:["doRequest"],tokenMode:!0,initialState:"enabled",init:function(t){var i=this;this.findBox=this.target.find("input").addBack("input").on("change",function(t){var e;!i._inChange&&i.onChange&&(e=d(this),i.onChange(e.val())&&e.blur())});var e={minLength:0,source:function(t,e){i.reportCallback=e,i.doRequest(t.term)},select:function(t,e){e.item&&(i.onSelect&&i.onSelect(e.item),i.onAdded&&i.onAdded(e.item))},focus:function(t,e){t.preventDefault(),d(this).val(e.item.label)}};this.tokenMode?this.findBox.on("tokenfield:removedtoken",function(t){i.onRemoved&&i.onRemoved(t.attrs.value)}).tokenfield({autocomplete:e}):this.findBox.autocomplete(e),"disabled"===this.initialState&&this.findBox[this.tokenMode?"tokenfield":"autocomplete"]("disable"),c.pass(this,u.AutocompleteWidget,"init",t)},resetValue:function(t){this._inChange=!0,this.tokenMode?this.findBox.tokenfield("enable").tokenfield("setTokens",t):this.findBox.autocomplete("enable").val(t),this._inChange=!1},onFound:function(t){this.findBox[this.tokenMode?"tokenfield":"autocomplete"]("enable"),this.reportCallback&&this.reportCallback(t),this.reportCallback=null}},u.SimpleItemWidget=function(t){c.extend(!0,this,c.common(t,this)),this.target=d(t.target)},u.SimpleItemWidget.prototype={template:null,classes:null,renderItem:function(t){return u.ui.getTemplate(template,t).addClass(this.classes)}},u.AccordionExpansion=function(t){c.extend(!0,this,c.common(t,this)),this.target=d(t.target),this.header=null,this.id=t.id,this.automatic&&(t.target=this.makeExpansion())},u.AccordionExpansion.prototype={automatic:!0,title:null,classes:null,expansionTemplate:null,before:null,renderExpansion:function(t){return u.ui.getTemplate(this.expansionTemplate,t).addClass(this.classes)},makeExpansion:function(t,e){if(!this.header){e=e||this,t=t||this.before;var i=this.renderExpansion(e);return this.accordion=this.target,t?"number"==typeof t?this.accordion.children().eq(t).before(i):"string"==typeof t?d(t,this.accordion[0]).before(i):d(t).before(i):this.accordion.append(i),this.refresh(),this.header=d("#"+this.id+"_header"),this.target=d("#"+this.id)}},getHeaderText:function(){return this.header.contents().filter(function(){return 3==this.nodeType})[0]},refresh:function(){this.accordion.accordion("refresh")}},u.SliderWidget=function(t){c.extend(!0,this,c.common(t,this)),this.target=d(t.target),this.prepareLimits(t.limits),null==this.initial&&(this.initial=this.isRange?[this.limits[0],this.limits[1]]:(this.limits[0]+this.limits[1])/2),this.target.val(Array.isArray(this.initial)?this.initial.join(","):this.initial),this.automatic&&this.makeSlider()},u.SliderWidget.prototype={__expects:["updateHandler"],limits:null,units:null,initial:null,title:null,width:null,automatic:!0,isRange:!0,showScale:!0,format:"%s {{units}}",prepareLimits:function(t){this.limits="string"==typeof t?t.split(","):t,this.limits[0]=parseFloat(this.limits[0]),this.limits[1]=parseFloat(this.limits[1]),this.precision=Math.pow(10,parseInt(Math.min(1,Math.floor(Math.log10(this.limits[1]-this.limits[0]+1)-3)))),this.precision<1&&.01<this.precision&&(this.precison=.01)},updateSlider:function(t,e){Array.isArray(t)&&(t=t.join(",")),null!=e?(this.prepareLimits(e),this.target.jRange("updateRange",this.limits,t)):this.target.jRange("setValue",t)},makeSlider:function(){var e=this,t=this.limits[1]>this.limits[0],i=[u.nicifyNumber(this.limits[0],this.precision),this.title+(t||!this.units?"":" ("+this.units+")"),u.nicifyNumber(this.limits[1],this.precision)],n=e.updateHandler(),a={from:this.limits[0],to:this.limits[1],step:this.precision,scale:i,showScale:this.showScale,showLabels:t,disable:!t,isRange:this.isRange,width:this.width,format:u.formatString(this.format,this)||""};return null!=this.color&&(a.theme="theme-"+this.color),a.ondragend=function(t){return"string"==typeof t&&e.isRange&&(t=t.split(",")),t=Array.isArray(t)?t.map(function(t){return parseFloat(t)}):parseFloat(t),n(t)},this.target.jRange(a)}},CurrentSearchWidgeting=function(t){c.extend(!0,this,c.common(t,this)),this.target=t.target,this.id=t.id,this.manager=null,this.facetWidgets={},this.fqName=this.useJson?"json.filter":"fq"},CurrentSearchWidgeting.prototype={useJson:!1,renderItem:null,init:function(t){c.pass(this,CurrentSearchWidgeting,"init",t),this.manager=t},registerWidget:function(t,e){this.facetWidgets[t.id]=e},afterTranslation:function(t){var e=this,i=[],n=this.manager.getParameter("q"),a=this.manager.getAllValues(this.fqName);n.value&&!n.value.match(/^(\*:)?\*$/)&&i.push(e.renderItem({title:n.value,count:"x",onMain:function(){return n.value="",e.manager.doRequest(),!1}}).addClass("tag_fixed"));for(var r=0,s=null!=a?a.length:0;r<s;r++){var o,l=a[r],u=null;for(var c in e.facetWidgets)if(u=(o=e.manager.getListener(c)).fqParse(l))break;if(null!=u){Array.isArray(u)||(u=[u]);for(var d=0,h=u.length;d<h;++d){var p,g=u[d],f="function"==typeof o.prepareTag?o.prepareTag(g):{title:g,count:"x",color:o.color,onMain:o.unclickHandler(g)};i.push(p=e.renderItem(f).addClass("tag_selected "+(f.onAux?"tag_open":"tag_fixed"))),1<h&&p.addClass("tag_combined")}1<h&&p.addClass("tag_last")}}i.length?(i.push(e.renderItem({title:"Clear",onMain:function(){for(var t in n.value="",e.facetWidgets)e.manager.getListener(t).clearValues();return e.manager.doRequest(),!1}}).addClass("tag_selected tag_clear tag_fixed")),this.target.empty().addClass("tags").append(i)):this.target.removeClass("tags").html("<li>No filters selected!</li>")}},u.CurrentSearchWidget=c(CurrentSearchWidgeting),u.Switching=function(t){c.extend(!0,this,c.common(t,u.Switching.prototype));var i=this,e=d(i.switchSelector,d(t.target)[0]),n=_.get(i,i.switchField);"boolean"==typeof n?e[0].checked=n:e.val(n),e.on("change",function(t){var e=d(this).val();c.path(i,i.switchField,"boolean"==typeof n?this.checked||"on"===e:e),c.act(i,i.onSwitching,t),t.stopPropagation()})},u.Switching.prototype={switchSelector:".switcher",switchField:null,onSwitching:null},u.Running=function(t){c.extend(!0,this,c.common(t,u.Running.prototype));var e=this,i=d(e.runSelector,d(t.target)[0]),n=e.runTarget||e;i.on("click",function(t){c.act(n,e.runMethod,this,t),t.stopPropagation()})},u.Running.prototype={runSelector:".switcher",runMethod:null,runTarget:null},u.tables={nextPage:function(){(null==this.entriesCount||this.pageStart+this.pageSize<this.entriesCount)&&this.queryEntries(this.pageStart+this.pageSize)},prevPage:function(){0<this.pageStart&&this.queryEntries(this.pageStart-this.pageSize)},updateControls:function(t,e){var i=d(".jtox-controls",this.rootElement);u.ui.updateTree(i,{pagestart:0<e?t+1:0,pageend:t+e}),i=i[0];var n=d(".next-field",i);null==this.entriesCount||t+e<this.entriesCount?d(n).addClass("paginate_enabled_next").removeClass("paginate_disabled_next"):d(n).addClass("paginate_disabled_next").removeClass("paginate_enabled_next");var a=d(".prev-field",i);0<t?d(a).addClass("paginate_enabled_previous").removeClass("paginate_disabled_previous"):d(a).addClass("paginate_disabled_previous").removeClass("paginate_enabled_previous")},modifyColDef:function(i,t,e,n){if(t.title===undefined||null==t.title)return null;var a=t.title.toLowerCase(),r=function(t){var e=i.settings.columns[t];return null!=e&&(n?null!=(e=e[n])&&(null!=e.visible&&(e[a]=e[a]||{},e[a].visible=!!e[a].visible||!!e.visible),e=e[a]):e=e[a]),null==e&&(e={}),e};return null==(t=d.extend(t,n?r("_"):{},r(e))).visible||t.visible?t:null},sortColDefs:function(t){for(var e=0,i=t.length;e<i;++e)t[e].naturalOrder=e;t.sort(function(t,e){var i=(t.order||0)-(e.order||0);return 0==i&&(i=t.naturalOrder-e.naturalOrder),i})},processColumns:function(t,e){var i=[],n=t.settings.columns[e];for(var a in n){var r=this.modifyColDef(t,n[a],e);null!=r&&i.push(r)}return this.sortColDefs(i),i},renderMulti:function(t,e,i,n,a){if((o=t.length)<2)return n(t[0],e,i);for(var r="<table"+(a?" "+_.map(a,function(t,e){return"data-"+e+'="'+t+'"'}).join(" "):"")+">",s=0,o=t.length;s<o;++s)r+='<tr class="'+(s%2==0?"even":"odd")+'"><td>'+n(t[s],e,i,s)+"</td></tr>";return r+="</table>"},inlineChanger:function(n,t,a,r){return null==r&&(r="changed"),"select"==t?function(t,e,i){return"display"!=e?t||"":'<select class="jt-inlineaction jtox-handler" data-handler="'+r+'" data-data="'+n+'" value="'+(t||"")+'">'+(a||"")+"</select>"}:"checkbox"==t?function(t,e,i){return"display"!=e?t||"":'<input type="checkbox" class="jt-inlineaction jtox-handler" data-handler="'+r+'" data-data="'+n+'"'+(a&&t==a||t?'checked="checked"':"")+'"/>'}:"text"==t?function(t,e,i){return"display"!=e?t||"":'<input type="text" class="jt-inlineaction jtox-handler" data-handler="'+r+'" data-data="'+n+'" value="'+(t||"")+'"'+(a?' placeholder="'+a+'"':"")+"/>"}:void 0},installMultiSelect:function(t,e,i){null==i&&(i=function(t){return t.parentNode}),d("a.select-all",t).on("click",function(t){d('input[type="checkbox"]',i(this)).each(function(){this.checked=!0,null==e&&d(this).trigger("change")}),null!=e&&e.call(this,t)}),d("a.unselect-all",t).on("click",function(t){d('input[type="checkbox"]',i(this)).each(function(){this.checked=!1,null==e&&d(this).trigger("change")}),null!=e&&e.call(this,t)})},installHandlers:function(i,t){null==t&&(t=i.rootElement),d(".jtox-handler",t).each(function(){var t=d(this).data("handler"),e=_.get(i.settings,["configuration","handlers",t],null)||window[t];e?"INPUT"==this.tagName||"SELECT"==this.tagName||"TEXTAREA"==this.tagName?d(this).on("change",_.bind(e,i)).on("keydown",u.ui.enterBlur):d(this).on("click",_.bind(e,i)):console.log("jToxQuery: referring unknown handler: "+t)})},columnData:function(t,e,i){var n=new Array(e.length);null==i&&(i="display");for(var a=0,r=e.length;a<r;++a){for(var s={},o=e[a],l=0,u=t.length;l<u;++l){var c=t[l],d=_.get(o,c.data,c.defaultValue);s[c.title]="function"!=typeof c.render?d:c.render(d,i,o)}n[a]=s}return n},queryInfo:function(t){for(var e={},i=0,n=t.length;i<n;++i)e[t[i].name]=t[i].value;return 0<e.sortingCols?(e.sortDirection=e.sortDir_0.toLowerCase(),e.sortData=e["dataProp_"+e.sortCol_0]):(e.sortDirection=0,e.sortData=""),e},putTable:function(a,t,e,i){var r=a.settings.onRow;r===undefined&&null!=i&&(r=i.onRow);var n=d.extend({paging:!1,processing:!0,lengthChange:!1,autoWidth:!1,dom:a.settings.dom,language:a.settings.oLanguage,serverSide:!1,createdRow:function(i,n,t){if("function"==typeof r&&!1===u.fireCallback(r,a,i,n,t))return;u.tables.equalizeHeights.apply(window,d("td.jtox-multi table tbody",i).toArray()),u.tables.installHandlers(a,i),"function"==typeof a.settings.selectionHandler&&d("input.jt-selection",i).on("change",a.settings.selectionHandler),a.settings.onDetails&&d(".jtox-details-toggle",i).on("click",function(t){var e=u.tables.toggleDetails(t,i);e&&u.fireCallback(a.settings.onDetails,a,e,n,this)})}},i);null==n.columns&&(n.columns=u.tables.processColumns(a,e)),null==n.language&&delete n.language;var s=d(t).dataTable(n);return d(s).DataTable().columns.adjust(),s},bindControls:function(t,i){var n,e=d(".jtox-controls",t.rootElement);t.settings.showControls?(u.ui.updateTree(e,{pagesize:t.settings.pageSize}),e=e[0],d(".next-field",e).on("click",i.nextPage),d(".prev-field",e).on("click",i.prevPage),d("select",e).on("change",i.sizeChange),n=null,d("input",e).on("keydown",function(t){var e=this;null!=n&&clearTimeout(n),n=setTimeout(function(){i.filter.apply(e,[t])},350)})):e.style.display="none"},putActions:function(a,t,r){var s;return(a.settings.selectionHandler||a.settings.onDetails)&&(s=t.render,t.render=function(t,e,i){var n=s(t,e,i);return"display"!=e||(r&&(n=""),a.settings.selectionHandler&&(n='<input type="checkbox" value="'+t+'" class="'+("string"==typeof a.settings.selectionHandler?'jtox-handler" data-handler="'+a.settings.selectionHandler+'"':'jt-selection"')+"/>"+n),a.settings.onDetails&&(n+='<span class="jtox-details-toggle ui-icon ui-icon-folder-collapsed" data-data="'+t+'" title="Press to open/close detailed info for this entry"></span>')),n}),t},toggleDetails:function(t,e){d(t.currentTarget).toggleClass("ui-icon-folder-collapsed"),d(t.currentTarget).toggleClass("ui-icon-folder-open"),d(t.currentTarget).toggleClass("jtox-openned"),e=e||d(t.currentTarget).parents("tr")[0];var i=d(t.currentTarget).parents("td")[0];if(d(t.currentTarget).hasClass("jtox-openned")){var n=document.createElement("tr"),a=document.createElement("td");return n.appendChild(a),d(a).addClass("jtox-details"),a.setAttribute("colspan",d(e).children().length-1),e.parentNode.insertBefore(n,e.nextElementSibling),i.setAttribute("rowspan","2"),a}return i.removeAttribute("rowspan"),d(d(e).next()).remove(),null},equalizeHeights:function(){for(var t=[],e=0;e<arguments.length;++e)t[e]=arguments[e].firstElementChild;for(;;){for(var i=0,e=0;e<t.length;++e)null!=t[e]&&(d(t[e]).hasClass("lock-height")||""==t[e].style.height||(t[e].style.height="auto"),t[e].offsetHeight>i&&(i=t[e].offsetHeight));if(0==i)break;for(e=0;e<t.length;++e)null!=t[e]&&(d(t[e]).height(i),t[e]=t[e].nextElementSibling)}}},u.ambit={processEntry:function(t,e,i){for(var n in i=i||defaultSettings.fnAccumulate,t.values){var a=e[n];if(a){var r=t.values[n];if(a.accumulate&&r&&a.data){var s="function"==typeof a.accumulate?a.accumulate:i,o=a.data;d.isArray(o)||(o=[o]);for(var l=0;l<o.length;++l)_.set(t,o[l],u.fireCallback(s,this,n,_.get(t,o[l]),r,e))}}}return t},extractFeatures:function(t,e,i){var n=[];for(var a in e){var r=d.extend({},e[a]);r.value=t.values[a],r.title&&!1!==u.fireCallback(i,null,r,a,n.length)&&(r.value||(r.value="-"),n.push(r))}return n},parseFeatureId:function(t){var e=t.match(/https?\:\/\/(.*)\/property\/([^\/]+)\/([^\/]+)\/.+/);return null==e?null:{topcategory:e[2].replace("+"," "),category:e[3].replace("+"," ")}},diagramUri:function(t){return t&&"string"==typeof t?t.replace(/(.+)(\/conformer.*)/,"$1")+"?media=image/png":""},enumSameAs:function(t,e,i){for(var n=e[t],a=t.replace(/(http.+\/feature\/).*/g,"$1"),r=t;u.fireCallback(i,null,n,r),null!=n.sameAs&&n.sameAs!=t&&t!=a+n.sameAs;){if(e[n.sameAs]!==undefined)r=n.sameAs;else{if(e[a+n.sameAs]===undefined)break;r=a+n.sameAs}n=e[r]}return r},processFeatures:function(t,e){for(var i in null==e&&(e=u.ambit.baseFeatures),t=d.extend(t,e)){var n=t[i];n.URI||(n.URI=i),this.enumSameAs(i,t,function(t,e){var i=t.sameAs;t=d.extend(!0,t,n),n=d.extend(!0,n,t),t.sameAs=i})}return t},processDataset:function(t,e,i,n){e||(this.processFeatures(t.feature),e=t.feature),i=i||defaultSettings.fnAccumulate,n=n||0;for(var a=0,r=t.dataEntry.length;a<r;++a)this.processEntry(t.dataEntry[a],e,i),t.dataEntry[a].number=a+1+n,t.dataEntry[a].index=a;return t},formatExtIdentifiers:function(t,e,i){if("display"!=e)return _.map(t,"id").join(", ");for(var n="",a=0;a<t.length;++a){0<a&&(n+="<br/>");var r=t[a].id;try{r.startsWith("http")&&(r="<a href='"+r+"' target=_blank class='qxternal'>"+r+"</a>")}catch(s){}n+=t[a].type+"&nbsp;=&nbsp;"+r}return n},getDatasetValue:function(t,e,i){return _.compact(_.union(e,null!=i?i.trim().toLowerCase().split("|"):[i]))},getDiagramUri:function(t){return t&&"string"==typeof t?t.replace(/(.+)(\/conformer.*)/,"$1")+"?media=image/png":""},grabPaging:function(t,e){var i,n,a=u.parseURL(e);return a.params.pagesize!==undefined&&(0<(i=parseInt(a.params.pagesize))&&(t.settings.pageSize=t.pageSize=i),e=u.removeParameter(e,"pagesize")),a.params.page!==undefined&&(0<=(n=parseInt(a.params.page))&&(t.settings.pageStart=t.pageStart=n*t.settings.pageSize),e=u.removeParameter(e,"page")),e},call:function(n,a,r){var t=(o=d.extend({},n.settings.ajaxSettings)).plainText?"text/plain":o.jsonp?"application/x-javascript":"application/json";o.data?o.method||(o.method="POST"):(o.jsonp&&(o.data={media:t}),o.method||(o.method="GET")),o.dataType||(o.dataType=o.plainText?"text":o.jsonp?"jsonp":"json"),o.type||(o.type=o.method),0!=a.indexOf("http")&&(a=n.settings.baseUrl+a);var s=self.callId++,o=d.extend(o,{url:a,headers:{Accept:t},crossDomain:o.crossDomain||o.jsonp,timeout:parseInt(o.timeout),jsonp:!!o.jsonp&&"callback",error:function(t,e,i){u.fireCallback(o.onError,n,a,e,t,s),u.fireCallback(r,n,null,t)},success:function(t,e,i){u.fireCallback(o.onSuccess,n,a,e,i,s),u.fireCallback(r,n,t,i)}});u.fireCallback(o.onConnect,n,o,s),d.ajax(o)},baseFeatures:{"http://www.opentox.org/api/1.1#REACHRegistrationDate":{title:"REACH Date",data:"compound.reachdate",accumulate:!0,basic:!0},"http://www.opentox.org/api/1.1#CASRN":{title:"CAS",data:"compound.cas",accumulate:!0,basic:!0,primary:!0},"http://www.opentox.org/api/1.1#ChemicalName":{title:"Name",data:"compound.name",accumulate:!0,basic:!0},"http://www.opentox.org/api/1.1#TradeName":{title:"Trade Name",data:"compound.tradename",accumulate:!0,basic:!0},"http://www.opentox.org/api/1.1#IUPACName":{title:"IUPAC Name",data:["compound.name","compound.iupac"],accumulate:!0,basic:!0},"http://www.opentox.org/api/1.1#EINECS":{title:"EINECS",data:"compound.einecs",accumulate:!0,basic:!0,primary:!0},"http://www.opentox.org/api/1.1#InChI":{title:"InChI",data:"compound.inchi",shorten:!0,accumulate:!0,basic:!0},"http://www.opentox.org/api/1.1#InChI_std":{title:"InChI",data:"compound.inchi",shorten:!0,accumulate:!0,sameAs:"http://www.opentox.org/api/1.1#InChI",basic:!0},"http://www.opentox.org/api/1.1#InChIKey":{title:"InChI Key",data:"compound.inchikey",accumulate:!0,basic:!0},"http://www.opentox.org/api/1.1#InChIKey_std":{title:"InChI Key",data:"compound.inchikey",accumulate:!0,sameAs:"http://www.opentox.org/api/1.1#InChIKey",basic:!0},"http://www.opentox.org/api/1.1#InChI_AuxInfo":{title:"InChI Aux",data:"compound.inchiaux",accumulate:!0,basic:!0},"http://www.opentox.org/api/1.1#InChI_AuxInfo_std":{title:"InChI Aux",data:"compound.inchiaux",accumulate:!0,sameAs:"http://www.opentox.org/api/1.1#InChI_AuxInfo",basic:!0},"http://www.opentox.org/api/1.1#IUCLID5_UUID":{title:"IUCLID5 UUID",data:"compound.i5uuid",shorten:!0,accumulate:!0,basic:!0,primary:!0},"http://www.opentox.org/api/1.1#SMILES":{title:"SMILES",data:"compound.smiles",shorten:!0,accumulate:!0,basic:!0},"http://www.opentox.org/api/dblinks#CMS":{title:"CMS",accumulate:!0,basic:!0},"http://www.opentox.org/api/dblinks#ChEBI":{title:"ChEBI",accumulate:!0,basic:!0},"http://www.opentox.org/api/dblinks#Pubchem":{title:"PubChem",accumulate:!0,basic:!0},"http://www.opentox.org/api/dblinks#ChemSpider":{title:"ChemSpider",accumulate:!0,basic:!0},"http://www.opentox.org/api/dblinks#ChEMBL":{title:"ChEMBL",accumulate:!0,basic:!0},"http://www.opentox.org/api/dblinks#ToxbankWiki":{title:"Toxbank Wiki",accumulate:!0,basic:!0},"http://www.opentox.org/api/1.1#Diagram":{title:"Diagram",search:!1,visibility:"main",primary:!0,data:"compound.URI",column:{className:"paddingless",width:"125px"},render:function(t,e,i){return dUri=u.ambit.getDiagramUri(t),"display"!=e?dUri:'<div class="jtox-diagram borderless"><span class="ui-icon ui-icon-zoomin"></span><a target="_blank" href="'+t+'"><img src="'+dUri+'" class="jtox-smalldiagram"/></a></div>'}}}}}(jToxKit,asSys,jQuery);